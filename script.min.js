let dots,snakes=[];const numDots=2e4,numAISnakes=10,snakeLength=10;let snake,diff,firacode,randDir,score=0,zoom=1,counterBall=0,speedTimer=0,timer=0;var mode=1;let sortedSnakesByLength=snakes;function preload(){firacode=loadFont("Fira-Code.ttf")}function setup(){if(createCanvas(windowWidth,windowHeight),colorMode(HSB,360,100,100),0==mode)background(220,0,15);else{dots=[];for(let s=0;s<numDots;s++)dots.push(new BouncyDot);snake=new Snake(width/2,height/2),snakes.push(snake);for(let s=0;s<numAISnakes;s++)snakes.push(new AISnake)}}function incMode(){mode=0==mode?1:0}function padNum(s,t){let e="";if(s){for(s=s.toString();e.length<t;)e+=" ";e+=s}return e}function padName(s,t){if(s){for(s=s.toString();s.length<t;)s+=" ";for(;s.length>t;)s=s.slice(0,t)}return s}function draw(){if(0==mode)clear(),background(220,0,15),a=createButton("Start"),a.position(width/2,height/1.5),a.mousePressed(incMode()),textAlign(CENTER),textFont(firacode,25);else{clear(),background(220,0,15),textSize(14),fill(95),score=snake.length,text("Your length: "+snake.length,20,height-20),translate(width/2,height/2);let s=40/(snake.size+40);for(zoom=lerp(zoom,s,.1),scale(zoom),translate(-snake.pos.x,-snake.pos.y);snakes.length<numAISnakes;)snakes.push(new AISnake);for(;dots.length<numDots;)dots.push(new BouncyDot);for(let s=snakes.length-1;s>=0;s--)for(let t=dots.length-1;t>=0;t--)if(snakes[s].eatsBlob(dots[t])){diff=floor(dots[t].r/3),snakes[s].length+=diff;for(let t=0;t<diff;t++)snakes[s].addTailSegment();snakes[s].length%20==0&&(snakes[s].size=floor(snakes[s].length/20)),dots.splice(t,1)}for(let s=dots.length-1;s>=0;s--)dots[s].display();for(let s=snakes.length-1;s>=0;s--)snakes[s].draw();frameCount%50==0&&updateLeaderboard(),showLeaderboard()}}function showLeaderboard(){for(let s=5;s>=0;s--)fill(sortedSnakesByLength[s].color,sortedSnakesByLength[s].sat,80),textFont(firacode,12*zoom),text(padName(sortedSnakesByLength[s].name,10)+padNum(sortedSnakesByLength[s].length,5),snake.pos.x+width/2.7,snake.pos.y-height/2.2+12*s),fill(255),text("Leaderboard",snake.pos.x+width/2.7,snake.pos.y-height/2.7-72)}function updateLeaderboard(){sortedSnakesByLength.sort((s,t)=>s.length<t.length?1:-1);for(let s of sortedSnakesByLength)console.log(s.name),console.log(s.length);console.log("------")}class BouncyDot{constructor(s,t,e,i,h,o){this.x=null!=s?s:random(20*-width,20*width),this.y=null!=t?t:random(20*-height,20*height),this.r=null!=e?e:random(3,10),this.color=null!=i?i:random(360),this.baseXVelocity=null!=h?h:random(0,.2),this.baseYVelocity=null!=o?o:random(0,.2),this.xVelocity=this.baseXVelocity,this.yVelocity=this.baseYVelocity}float(){this.x+=this.xVelocity,this.y+=this.yVelocity,this.x+this.r>width&&(this.xVelocity=-1*this.baseXVelocity),this.x-this.r<0&&(this.xVelocity=this.baseXVelocity),this.y+this.r>height&&(this.yVelocity=-1*this.baseYVelocity),this.y-this.r<0&&(this.yVelocity=this.baseYVelocity)}display(){this.x>=snake.pos.x-width&&this.x<=snake.pos.x+width&&this.y>=snake.pos.y-height&&this.y<=snake.pos.y+height&&(fill(this.color,70,100),noStroke(),ellipse(this.x,this.y,2*this.r))}}class AISnake{constructor(){this.pos=createVector(random(-width,width),random(-height,height)),this.vel=createVector(0,0),this.size=0,this.arr=[],this.length=10,this.color=random(360),this.sat=random(20,100),this.randomX=this.findClosestDot().x,this.randomY=this.findClosestDot().y,this.arr.push(new TailSegment(this.pos.x,this.pos.y));for(let s=1;s<this.length;s++)this.arr.push(new TailSegment(this.arr[s-1].pos.x,this.arr[s-1].pos.y));this.nameList=["Adrian","Arianne","Ash","Carlos","Christ","Donna","Emily","Felicia","Gabriel","Galilea","Heldanna","Isabel","Janat","Joe","Jonah","Jose","Juan ","Julia","Kate","Megan","Meryl","Nikki","Nneoma","Ojasw","Olivia","Orlando","Peter","Savar","Youshra"],this.name=this.nameList[floor(random()*this.nameList.length)]}draw(){frameCount%20==0&&(this.randomX=this.findClosestDot().x,this.randomY=this.findClosestDot().y),(randDir=createVector(this.randomX-this.pos.x,this.randomY-this.pos.y)).setMag(3),this.vel.lerp(randDir,.2),this.pos.add(this.vel),this.arr[0].pos.x=this.pos.x,this.arr[0].pos.y=this.pos.y;for(let s=this.arr.length-1;s>=1;s--)this.arr[s].pos.x=this.arr[s-1].pos.x,this.arr[s].pos.y=this.arr[s-1].pos.y,this.drawBody(this.arr[s].pos.x,this.arr[s].pos.y);this.drawHead();for(let s=snakes.length-1;s>=0;s--)snakes[s]!=this&&this.collideSnake(snakes[s])&&this.destroy();fill(this.color,60,60),text(this.name,this.pos.x+15,this.pos.y+15)}drawBody(s,t){fill(this.color,this.sat,100),ellipse(s,t,40+this.size)}drawHead(){let s=this.pos.x,t=this.pos.y;fill(this.color,this.sat,100),ellipse(s,t,40+this.size),fill(100);let e=(randDir.x-width/2)/width*(18+this.size/2)/2,i=(randDir.y-height/2)/height*(18+this.size/2)/2,h=(randDir.x-width/2)/width*(18+this.size/2+(10+this.size/4))/2,o=(randDir.y-height/2)/height*(18+this.size/2+(10+this.size/4))/2;ellipse(s-9+e-this.size/4,t+i,18+this.size/2),ellipse(s+9+e+this.size/4,t+i,18+this.size/2),fill(0),ellipse(s-9+h-this.size/4,t+o,10+this.size/4),ellipse(s+9+h+this.size/4,t+o,10+this.size/4)}eatsBlob(s){return collideCircleCircle(this.pos.x,this.pos.y,40+this.size,s.x,s.y,s.r)}addTailSegment(){this.arr.push(new TailSegment(this.arr[this.arr.length-1].pos.x,this.arr[this.arr.length-1].pos.y))}collideSnake(s){for(let t=0;t<s.arr.length;t++){if(collideCircleCircle(this.pos.x,this.pos.y,40+this.size,s.arr[t].pos.x,s.arr[t].pos.y,40+s.size))return!0}}destroy(){for(let s=0;s<this.arr.length;s+=5)dots.push(new BouncyDot(this.arr[s].pos.x,this.arr[s].pos.y,10+this.size,this.color,.05,.05));let s=snakes.indexOf(this);s>-1&&snakes.splice(s,1)}findClosestDot(){let s=1/0,t=dots[0];for(let e=0;e<dots.length;e++){let i=sqrt((this.pos.x-dots[e].x)**2+(this.pos.y-dots[e].y)**2);i<s&&(s=i,t=dots[e])}return t}}class Snake{constructor(s,t){this.pos=createVector(s,t),this.vel=createVector(0,0),this.size=0,this.arr=[],this.length=10,this.name="YJ",this.color=random(360),this.sat=random(20,100),this.arr.push(new TailSegment(this.pos.x,this.pos.y));for(let s=1;s<this.length;s++)this.arr.push(new TailSegment(this.arr[s-1].pos.x,this.arr[s-1].pos.y))}draw(){let s=createVector(mouseX-width/2,mouseY-height/2);mouseIsPressed&&this.length>=10?(s.setMag(6),frameCount%20==0&&this.removeTailSegment()):s.setMag(3),this.vel.lerp(s,.2),this.pos.add(this.vel),this.arr[0].pos.x=this.pos.x,this.arr[0].pos.y=this.pos.y,mouseIsPressed&&this.length>=10&&this.length<=100&&this.drawGlow();for(let s=this.arr.length-1;s>=1;s--)this.arr[s].pos.x=this.arr[s-1].pos.x,this.arr[s].pos.y=this.arr[s-1].pos.y,this.drawBody(this.arr[s].pos.x,this.arr[s].pos.y);this.drawHead();for(let s=0;s<snakes.length;s++)snakes[s]!=this&&this.collideSnake(snakes[s])&&this.destroy();fill(this.color,60,60),text(this.name,this.pos.x+15,this.pos.y+15)}drawBody(s,t){fill(this.color,this.sat,80),ellipse(s,t,40+this.size)}drawGlow(){for(let s=1;s<this.arr.length;s++)drawingContext.shadowBlur=8,drawingContext.shadowColor=color(this.color,this.sat,100),fill(this.color,this.sat,80),ellipse(this.arr[s].pos.x,this.arr[s].pos.y,44+this.size);drawingContext.shadowBlur=0}drawHead(){let s=this.pos.x,t=this.pos.y;fill(this.color,this.sat,80),ellipse(s,t,40+this.size),fill(100);let e=(mouseX-width/2)/width*(18+this.size/2)/2,i=(mouseY-height/2)/height*(18+this.size/2)/2,h=(mouseX-width/2)/width*(18+this.size/2+(10+this.size/4))/2,o=(mouseY-height/2)/height*(18+this.size/2+(10+this.size/4))/2;ellipse(s-9+e-this.size/4,t+i,18+this.size/2),ellipse(s+9+e+this.size/4,t+i,18+this.size/2),fill(0),ellipse(s-9+h-this.size/4,t+o,10+this.size/4),ellipse(s+9+h+this.size/4,t+o,10+this.size/4)}eatsBlob(s){return collideCircleCircle(this.pos.x,this.pos.y,40+this.size,s.x,s.y,s.r)}addTailSegment(){this.arr.push(new TailSegment(this.arr[this.arr.length-1].pos.x,this.arr[this.arr.length-1].pos.y))}removeTailSegment(){this.arr.length>10&&this.arr.pop(),this.length--}collideSnake(s){for(let t=0;t<s.arr.length;t++){if(collideCircleCircle(this.pos.x,this.pos.y,40+this.size,s.arr[t].pos.x,s.arr[t].pos.y,40+s.size))return!0}}destroy(){for(let s=0;s<this.arr.length;s+=5)dots.push(new BouncyDot(this.arr[s].pos.x,this.arr[s].pos.y,10+this.size,this.color,.05,.05));snakes.splice(0,1)}}class TailSegment{constructor(s,t){this.pos=createVector(s,t)}draw(){fill(0,65,100),ellipse(this.pos.x,this.pos.y,50)}}